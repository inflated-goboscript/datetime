costumes "blank.svg";

%include inflator/assert
%include inflator/datetime

list test_years_from_1970_to_3000 = [5097600.0, 36633600.0, 68256000.0, 99792000.0, 131328000.0, 162864000.0, 194486400.0, 226022400.0, 257558400.0, 289094400.0, 320716800.0, 352252800.0, 383788800.0, 415324800.0, 446947200.0, 478483200.0, 510019200.0, 541555200.0, 573177600.0, 604713600.0, 636249600.0, 667785600.0, 699408000.0, 730944000.0, 762480000.0, 794016000.0, 825638400.0, 857174400.0, 888710400.0, 920246400.0, 951868800.0, 983404800.0, 1014940800.0, 1046476800.0, 1078099200.0, 1109635200.0, 1141171200.0, 1172707200.0, 1204329600.0, 1235865600.0, 1267401600.0, 1298937600.0, 1330560000.0, 1362096000.0, 1393632000.0, 1425168000.0, 1456790400.0, 1488326400.0, 1519862400.0, 1551398400.0, 1583020800.0, 1614556800.0, 1646092800.0, 1677628800.0, 1709251200.0, 1740787200.0, 1772323200.0, 1803859200.0, 1835481600.0, 1867017600.0, 1898553600.0, 1930089600.0, 1961712000.0, 1993248000.0, 2024784000.0, 2056320000.0, 2087942400.0, 2119478400.0, 2151014400.0, 2182550400.0, 2214172800.0, 2245708800.0, 2277244800.0, 2308780800.0, 2340403200.0, 2371939200.0, 2403475200.0, 2435011200.0, 2466633600.0, 2498169600.0, 2529705600.0, 2561241600.0, 2592864000.0, 2624400000.0, 2655936000.0, 2687472000.0, 2719094400.0, 2750630400.0, 2782166400.0, 2813702400.0, 2845324800.0, 2876860800.0, 2908396800.0, 2939932800.0, 2971555200.0, 3003091200.0, 3034627200.0, 3066163200.0, 3097785600.0, 3129321600.0, 3160857600.0, 3192393600.0, 3224016000.0, 3255552000.0, 3287088000.0, 3318624000.0, 3350246400.0, 3381782400.0, 3413318400.0, 3444854400.0, 3476476800.0, 3508012800.0, 3539548800.0, 3571084800.0, 3602707200.0, 3634243200.0, 3665779200.0, 3697315200.0, 3728937600.0, 3760473600.0, 3792009600.0, 3823545600.0, 3855168000.0, 3886704000.0, 3918240000.0, 3949776000.0, 3981398400.0, 4012934400.0, 4044470400.0, 4076006400.0, 4107542400.0, 4139078400.0, 4170614400.0, 4202150400.0, 4233772800.0, 4265308800.0, 4296844800.0, 4328380800.0, 4360003200.0, 4391539200.0, 4423075200.0, 4454611200.0, 4486233600.0, 4517769600.0, 4549305600.0, 4580841600.0, 4612464000.0, 4644000000.0, 4675536000.0, 4707072000.0, 4738694400.0, 4770230400.0, 4801766400.0, 4833302400.0, 4864924800.0, 4896460800.0, 4927996800.0, 4959532800.0, 4991155200.0, 5022691200.0, 5054227200.0, 5085763200.0, 5117385600.0, 5148921600.0, 5180457600.0, 5211993600.0, 5243616000.0, 5275152000.0, 5306688000.0, 5338224000.0, 5369846400.0, 5401382400.0, 5432918400.0, 5464454400.0, 5496076800.0, 5527612800.0, 5559148800.0, 5590684800.0, 5622307200.0, 5653843200.0, 5685379200.0, 5716915200.0, 5748537600.0, 5780073600.0, 5811609600.0, 5843145600.0, 5874768000.0, 5906304000.0, 5937840000.0, 5969376000.0, 6000998400.0, 6032534400.0, 6064070400.0, 6095606400.0, 6127228800.0, 6158764800.0, 6190300800.0, 6221836800.0, 6253459200.0, 6284995200.0, 6316531200.0, 6348067200.0, 6379689600.0, 6411225600.0, 6442761600.0, 6474297600.0, 6505920000.0, 6537456000.0, 6568992000.0, 6600528000.0, 6632150400.0, 6663686400.0, 6695222400.0, 6726758400.0, 6758380800.0, 6789916800.0, 6821452800.0, 6852988800.0, 6884611200.0, 6916147200.0, 6947683200.0, 6979219200.0, 7010841600.0, 7042377600.0, 7073913600.0, 7105449600.0, 7137072000.0, 7168608000.0, 7200144000.0, 7231680000.0, 7263216000.0, 7294752000.0, 7326288000.0, 7357824000.0, 7389446400.0, 7420982400.0, 7452518400.0, 7484054400.0, 7515676800.0, 7547212800.0, 7578748800.0, 7610284800.0, 7641907200.0, 7673443200.0, 7704979200.0, 7736515200.0, 7768137600.0, 7799673600.0, 7831209600.0, 7862745600.0, 7894368000.0, 7925904000.0, 7957440000.0, 7988976000.0, 8020598400.0, 8052134400.0, 8083670400.0, 8115206400.0, 8146828800.0, 8178364800.0, 8209900800.0, 8241436800.0, 8273059200.0, 8304595200.0, 8336131200.0, 8367667200.0, 8399289600.0, 8430825600.0, 8462361600.0, 8493897600.0, 8525520000.0, 8557056000.0, 8588592000.0, 8620128000.0, 8651750400.0, 8683286400.0, 8714822400.0, 8746358400.0, 8777980800.0, 8809516800.0, 8841052800.0, 8872588800.0, 8904211200.0, 8935747200.0, 8967283200.0, 8998819200.0, 9030441600.0, 9061977600.0, 9093513600.0, 9125049600.0, 9156672000.0, 9188208000.0, 9219744000.0, 9251280000.0, 9282902400.0, 9314438400.0, 9345974400.0, 9377510400.0, 9409132800.0, 9440668800.0, 9472204800.0, 9503740800.0, 9535363200.0, 9566899200.0, 9598435200.0, 9629971200.0, 9661593600.0, 9693129600.0, 9724665600.0, 9756201600.0, 9787824000.0, 9819360000.0, 9850896000.0, 9882432000.0, 9914054400.0, 9945590400.0, 9977126400.0, 10008662400.0, 10040284800.0, 10071820800.0, 10103356800.0, 10134892800.0, 10166515200.0, 10198051200.0, 10229587200.0, 10261123200.0, 10292745600.0, 10324281600.0, 10355817600.0, 10387353600.0, 10418889600.0, 10450425600.0, 10481961600.0, 10513497600.0, 10545120000.0, 10576656000.0, 10608192000.0, 10639728000.0, 10671350400.0, 10702886400.0, 10734422400.0, 10765958400.0, 10797580800.0, 10829116800.0, 10860652800.0, 10892188800.0, 10923811200.0, 10955347200.0, 10986883200.0, 11018419200.0, 11050041600.0, 11081577600.0, 11113113600.0, 11144649600.0, 11176272000.0, 11207808000.0, 11239344000.0, 11270880000.0, 11302502400.0, 11334038400.0, 11365574400.0, 11397110400.0, 11428732800.0, 11460268800.0, 11491804800.0, 11523340800.0, 11554963200.0, 11586499200.0, 11618035200.0, 11649571200.0, 11681193600.0, 11712729600.0, 11744265600.0, 11775801600.0, 11807424000.0, 11838960000.0, 11870496000.0, 11902032000.0, 11933654400.0, 11965190400.0, 11996726400.0, 12028262400.0, 12059884800.0, 12091420800.0, 12122956800.0, 12154492800.0, 12186115200.0, 12217651200.0, 12249187200.0, 12280723200.0, 12312345600.0, 12343881600.0, 12375417600.0, 12406953600.0, 12438576000.0, 12470112000.0, 12501648000.0, 12533184000.0, 12564806400.0, 12596342400.0, 12627878400.0, 12659414400.0, 12691036800.0, 12722572800.0, 12754108800.0, 12785644800.0, 12817267200.0, 12848803200.0, 12880339200.0, 12911875200.0, 12943497600.0, 12975033600.0, 13006569600.0, 13038105600.0, 13069728000.0, 13101264000.0, 13132800000.0, 13164336000.0, 13195958400.0, 13227494400.0, 13259030400.0, 13290566400.0, 13322188800.0, 13353724800.0, 13385260800.0, 13416796800.0, 13448419200.0, 13479955200.0, 13511491200.0, 13543027200.0, 13574649600.0, 13606185600.0, 13637721600.0, 13669257600.0, 13700880000.0, 13732416000.0, 13763952000.0, 13795488000.0, 13827110400.0, 13858646400.0, 13890182400.0, 13921718400.0, 13953340800.0, 13984876800.0, 14016412800.0, 14047948800.0, 14079571200.0, 14111107200.0, 14142643200.0, 14174179200.0, 14205801600.0, 14237337600.0, 14268873600.0, 14300409600.0, 14332032000.0, 14363568000.0, 14395104000.0, 14426640000.0, 14458262400.0, 14489798400.0, 14521334400.0, 14552870400.0, 14584492800.0, 14616028800.0, 14647564800.0, 14679100800.0, 14710723200.0, 14742259200.0, 14773795200.0, 14805331200.0, 14836953600.0, 14868489600.0, 14900025600.0, 14931561600.0, 14963184000.0, 14994720000.0, 15026256000.0, 15057792000.0, 15089414400.0, 15120950400.0, 15152486400.0, 15184022400.0, 15215644800.0, 15247180800.0, 15278716800.0, 15310252800.0, 15341875200.0, 15373411200.0, 15404947200.0, 15436483200.0, 15468105600.0, 15499641600.0, 15531177600.0, 15562713600.0, 15594336000.0, 15625872000.0, 15657408000.0, 15688944000.0, 15720566400.0, 15752102400.0, 15783638400.0, 15815174400.0, 15846796800.0, 15878332800.0, 15909868800.0, 15941404800.0, 15973027200.0, 16004563200.0, 16036099200.0, 16067635200.0, 16099257600.0, 16130793600.0, 16162329600.0, 16193865600.0, 16225488000.0, 16257024000.0, 16288560000.0, 16320096000.0, 16351718400.0, 16383254400.0, 16414790400.0, 16446326400.0, 16477948800.0, 16509484800.0, 16541020800.0, 16572556800.0, 16604179200.0, 16635715200.0, 16667251200.0, 16698787200.0, 16730323200.0, 16761859200.0, 16793395200.0, 16824931200.0, 16856553600.0, 16888089600.0, 16919625600.0, 16951161600.0, 16982784000.0, 17014320000.0, 17045856000.0, 17077392000.0, 17109014400.0, 17140550400.0, 17172086400.0, 17203622400.0, 17235244800.0, 17266780800.0, 17298316800.0, 17329852800.0, 17361475200.0, 17393011200.0, 17424547200.0, 17456083200.0, 17487705600.0, 17519241600.0, 17550777600.0, 17582313600.0, 17613936000.0, 17645472000.0, 17677008000.0, 17708544000.0, 17740166400.0, 17771702400.0, 17803238400.0, 17834774400.0, 17866396800.0, 17897932800.0, 17929468800.0, 17961004800.0, 17992627200.0, 18024163200.0, 18055699200.0, 18087235200.0, 18118857600.0, 18150393600.0, 18181929600.0, 18213465600.0, 18245088000.0, 18276624000.0, 18308160000.0, 18339696000.0, 18371318400.0, 18402854400.0, 18434390400.0, 18465926400.0, 18497548800.0, 18529084800.0, 18560620800.0, 18592156800.0, 18623779200.0, 18655315200.0, 18686851200.0, 18718387200.0, 18750009600.0, 18781545600.0, 18813081600.0, 18844617600.0, 18876240000.0, 18907776000.0, 18939312000.0, 18970848000.0, 19002470400.0, 19034006400.0, 19065542400.0, 19097078400.0, 19128700800.0, 19160236800.0, 19191772800.0, 19223308800.0, 19254931200.0, 19286467200.0, 19318003200.0, 19349539200.0, 19381161600.0, 19412697600.0, 19444233600.0, 19475769600.0, 19507392000.0, 19538928000.0, 19570464000.0, 19602000000.0, 19633622400.0, 19665158400.0, 19696694400.0, 19728230400.0, 19759852800.0, 19791388800.0, 19822924800.0, 19854460800.0, 19885996800.0, 19917532800.0, 19949068800.0, 19980604800.0, 20012227200.0, 20043763200.0, 20075299200.0, 20106835200.0, 20138457600.0, 20169993600.0, 20201529600.0, 20233065600.0, 20264688000.0, 20296224000.0, 20327760000.0, 20359296000.0, 20390918400.0, 20422454400.0, 20453990400.0, 20485526400.0, 20517148800.0, 20548684800.0, 20580220800.0, 20611756800.0, 20643379200.0, 20674915200.0, 20706451200.0, 20737987200.0, 20769609600.0, 20801145600.0, 20832681600.0, 20864217600.0, 20895840000.0, 20927376000.0, 20958912000.0, 20990448000.0, 21022070400.0, 21053606400.0, 21085142400.0, 21116678400.0, 21148300800.0, 21179836800.0, 21211372800.0, 21242908800.0, 21274531200.0, 21306067200.0, 21337603200.0, 21369139200.0, 21400761600.0, 21432297600.0, 21463833600.0, 21495369600.0, 21526992000.0, 21558528000.0, 21590064000.0, 21621600000.0, 21653222400.0, 21684758400.0, 21716294400.0, 21747830400.0, 21779452800.0, 21810988800.0, 21842524800.0, 21874060800.0, 21905683200.0, 21937219200.0, 21968755200.0, 22000291200.0, 22031913600.0, 22063449600.0, 22094985600.0, 22126521600.0, 22158144000.0, 22189680000.0, 22221216000.0, 22252752000.0, 22284374400.0, 22315910400.0, 22347446400.0, 22378982400.0, 22410604800.0, 22442140800.0, 22473676800.0, 22505212800.0, 22536835200.0, 22568371200.0, 22599907200.0, 22631443200.0, 22663065600.0, 22694601600.0, 22726137600.0, 22757673600.0, 22789296000.0, 22820832000.0, 22852368000.0, 22883904000.0, 22915526400.0, 22947062400.0, 22978598400.0, 23010134400.0, 23041670400.0, 23073206400.0, 23104742400.0, 23136278400.0, 23167900800.0, 23199436800.0, 23230972800.0, 23262508800.0, 23294131200.0, 23325667200.0, 23357203200.0, 23388739200.0, 23420361600.0, 23451897600.0, 23483433600.0, 23514969600.0, 23546592000.0, 23578128000.0, 23609664000.0, 23641200000.0, 23672822400.0, 23704358400.0, 23735894400.0, 23767430400.0, 23799052800.0, 23830588800.0, 23862124800.0, 23893660800.0, 23925283200.0, 23956819200.0, 23988355200.0, 24019891200.0, 24051513600.0, 24083049600.0, 24114585600.0, 24146121600.0, 24177744000.0, 24209280000.0, 24240816000.0, 24272352000.0, 24303974400.0, 24335510400.0, 24367046400.0, 24398582400.0, 24430204800.0, 24461740800.0, 24493276800.0, 24524812800.0, 24556435200.0, 24587971200.0, 24619507200.0, 24651043200.0, 24682665600.0, 24714201600.0, 24745737600.0, 24777273600.0, 24808896000.0, 24840432000.0, 24871968000.0, 24903504000.0, 24935126400.0, 24966662400.0, 24998198400.0, 25029734400.0, 25061356800.0, 25092892800.0, 25124428800.0, 25155964800.0, 25187587200.0, 25219123200.0, 25250659200.0, 25282195200.0, 25313817600.0, 25345353600.0, 25376889600.0, 25408425600.0, 25440048000.0, 25471584000.0, 25503120000.0, 25534656000.0, 25566278400.0, 25597814400.0, 25629350400.0, 25660886400.0, 25692508800.0, 25724044800.0, 25755580800.0, 25787116800.0, 25818739200.0, 25850275200.0, 25881811200.0, 25913347200.0, 25944969600.0, 25976505600.0, 26008041600.0, 26039577600.0, 26071200000.0, 26102736000.0, 26134272000.0, 26165808000.0, 26197430400.0, 26228966400.0, 26260502400.0, 26292038400.0, 26323660800.0, 26355196800.0, 26386732800.0, 26418268800.0, 26449891200.0, 26481427200.0, 26512963200.0, 26544499200.0, 26576121600.0, 26607657600.0, 26639193600.0, 26670729600.0, 26702352000.0, 26733888000.0, 26765424000.0, 26796960000.0, 26828582400.0, 26860118400.0, 26891654400.0, 26923190400.0, 26954812800.0, 26986348800.0, 27017884800.0, 27049420800.0, 27081043200.0, 27112579200.0, 27144115200.0, 27175651200.0, 27207273600.0, 27238809600.0, 27270345600.0, 27301881600.0, 27333504000.0, 27365040000.0, 27396576000.0, 27428112000.0, 27459734400.0, 27491270400.0, 27522806400.0, 27554342400.0, 27585964800.0, 27617500800.0, 27649036800.0, 27680572800.0, 27712195200.0, 27743731200.0, 27775267200.0, 27806803200.0, 27838425600.0, 27869961600.0, 27901497600.0, 27933033600.0, 27964656000.0, 27996192000.0, 28027728000.0, 28059264000.0, 28090886400.0, 28122422400.0, 28153958400.0, 28185494400.0, 28217116800.0, 28248652800.0, 28280188800.0, 28311724800.0, 28343347200.0, 28374883200.0, 28406419200.0, 28437955200.0, 28469577600.0, 28501113600.0, 28532649600.0, 28564185600.0, 28595808000.0, 28627344000.0, 28658880000.0, 28690416000.0, 28722038400.0, 28753574400.0, 28785110400.0, 28816646400.0, 28848268800.0, 28879804800.0, 28911340800.0, 28942876800.0, 28974499200.0, 29006035200.0, 29037571200.0, 29069107200.0, 29100729600.0, 29132265600.0, 29163801600.0, 29195337600.0, 29226960000.0, 29258496000.0, 29290032000.0, 29321568000.0, 29353104000.0, 29384640000.0, 29416176000.0, 29447712000.0, 29479334400.0, 29510870400.0, 29542406400.0, 29573942400.0, 29605564800.0, 29637100800.0, 29668636800.0, 29700172800.0, 29731795200.0, 29763331200.0, 29794867200.0, 29826403200.0, 29858025600.0, 29889561600.0, 29921097600.0, 29952633600.0, 29984256000.0, 30015792000.0, 30047328000.0, 30078864000.0, 30110486400.0, 30142022400.0, 30173558400.0, 30205094400.0, 30236716800.0, 30268252800.0, 30299788800.0, 30331324800.0, 30362947200.0, 30394483200.0, 30426019200.0, 30457555200.0, 30489177600.0, 30520713600.0, 30552249600.0, 30583785600.0, 30615408000.0, 30646944000.0, 30678480000.0, 30710016000.0, 30741638400.0, 30773174400.0, 30804710400.0, 30836246400.0, 30867868800.0, 30899404800.0, 30930940800.0, 30962476800.0, 30994099200.0, 31025635200.0, 31057171200.0, 31088707200.0, 31120329600.0, 31151865600.0, 31183401600.0, 31214937600.0, 31246560000.0, 31278096000.0, 31309632000.0, 31341168000.0, 31372790400.0, 31404326400.0, 31435862400.0, 31467398400.0, 31499020800.0, 31530556800.0, 31562092800.0, 31593628800.0, 31625251200.0, 31656787200.0, 31688323200.0, 31719859200.0, 31751481600.0, 31783017600.0, 31814553600.0, 31846089600.0, 31877712000.0, 31909248000.0, 31940784000.0, 31972320000.0, 32003942400.0, 32035478400.0, 32067014400.0, 32098550400.0, 32130172800.0, 32161708800.0, 32193244800.0, 32224780800.0, 32256403200.0, 32287939200.0, 32319475200.0, 32351011200.0, 32382633600.0, 32414169600.0, 32445705600.0, 32477241600.0];


onflag {main;}
proc main {
    datetime dt = datetime {
        year: 2025,
        month: 9,
        day: 27,
        hour: 11,
        minute: 27,
        second: 47,
        microsecond: 459000,
        tzh: 1,
        tzm: 0,
    };
    assert_eq dt_to_isoformat(dt_from_isoformat("2025-09-27T11:27:47.459000+01:00")), "2025-09-27T11:27:47.459000+01:00";
    assert_eq dt_to_isoformat(dt_from_timestamp(1758968867.459)), "2025-09-27T10:27:47.459000Z";
    assert_eq dt_to_isoformat(dt_from_julian_timestamp(2460945.935965961)), "2025-09-27T10:27:47.459017Z";

    assert_eq dt_get_weekday(dt), "Saturday";
    assert_eq dt_get_weekday(DT_NOW()), CURRENT_WEEKDAY();

    assert_eq dt_to_isoformat(dt), "2025-09-27T11:27:47.459000+01:00";
    assert_eq dt_to_julian_timestamp(dt), 2460945.935965961;
    assert_eq dt_to_timestamp(dt), 1758968867.459;
    log dt_str(dt);

    log td_str(dt_sub(dt, dt_from_isoformat("2025-09-25T12:20:30.123456+01:00")));

    local i = 1;
    local year = 1970;
    repeat length test_years_from_1970_to_3000 {
        datetime dt = datetime {
            year: year,
            month: 3,
            day: 1,
            hour: 0,
            minute: 0,
            second: 0,
            microsecond: 0,
            tzh: 0,
            tzm: 0,
        };
        assert_eq dt_to_timestamp(dt), test_years_from_1970_to_3000[i];

        year++;
        i++;
    }
}
